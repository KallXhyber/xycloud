<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XyCloud - Rental PC Online</title>
    <!-- Tailwind CSS, Font Awesome, Google Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0c1424; color: #f3f4f6; background-image: url('https://i.imghippo.com/files/tQo8015OeU.jpg'); background-size: cover; background-position: center; background-attachment: fixed; }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.5s ease-in-out; }
        .monitor-stand { width: 40%; height: 10px; background-color: #374151; margin: 0 auto; }
        .monitor-base { width: 60%; height: 8px; background-color: #1f2937; margin: 0 auto; border-radius: 5px; }
        .status-dot { width: 10px; height: 10px; border-radius: 50%; position: absolute; top: 8px; right: 8px; }
        .bg-status-ready { background-color: #22c55e; box-shadow: 0 0 8px #22c55e; }
        .bg-status-digunakan { background-color: #ef4444; box-shadow: 0 0 8px #ef4444; }
        .bg-status-offline { background-color: #6b7280; box-shadow: 0 0 8px #6b7280; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1f2937; }
        ::-webkit-scrollbar-thumb { background: #38bdf8; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #7dd3fc; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes logo-pulse { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
        .animated-logo { animation: logo-pulse 4s ease-in-out infinite; }
        .toast { padding: 1rem 1.5rem; border-radius: 0.5rem; color: white; display: flex; align-items: center; gap: 1rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transform: translateX(120%); transition: transform 0.5s ease-in-out; }
        .toast.show { transform: translateX(0); }
        .toast-success { background-color: #22c55e; }
        .toast-error { background-color: #ef4444; }
        .toast-info { background-color: #3b82f6; }
        .backdrop-blur-custom { background-color: rgba(12, 20, 36, 0.5); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border: 1px solid rgba(255, 255, 255, 0.08); }
        #music-player { transition: all 0.4s ease-in-out; overflow: hidden;}
        #music-player-content { transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out; }
        #music-player.minimized { width: 56px; height: 56px; border-radius: 9999px; }
        #music-player.minimized #music-player-content { opacity: 0; pointer-events: none; transform: scale(0.5); }
        #music-player #minimized-icon { display: none; opacity: 0; transition: opacity 0.3s ease-in-out; }
        #music-player.minimized #minimized-icon { display: flex; opacity: 1; }
        input[type=range].volume-slider { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range].volume-slider::-webkit-slider-runnable-track { height: 4px; background: #4b5563; border-radius: 5px; }
        input[type=range].volume-slider::-webkit-slider-thumb { -webkit-appearance: none; height: 14px; width: 14px; border-radius: 50%; background: #e5e7eb; margin-top: -5px; cursor: pointer; }
    </style>
</head>
<body class="antialiased">

    <audio id="main-audio-player"></audio>
    <audio id="success-sound" src="https://g.top4top.io/m_3550wc2zd0.mp3"></audio>
    <audio id="error-sound" src="https://i.top4top.io/m_3549ihw3n0.mp3"></audio>
    <div id="toast-container" class="fixed top-4 right-4 z-[100] space-y-2 w-full max-w-xs"></div>
    
    <div id="music-player" class="fixed bottom-4 left-4 z-50 backdrop-blur-custom rounded-lg shadow-lg w-56">
        <div id="minimized-icon" class="w-full h-full items-center justify-center text-white cursor-pointer"><i class="fas fa-music"></i></div>
        <div id="music-player-content" class="p-2.5">
            <div class="flex items-center justify-between">
                <div>
                    <p id="track-title" class="text-white text-sm font-bold truncate">Memuat...</p>
                    <p id="track-artist" class="text-gray-400 text-xs">...</p>
                </div>
                <button id="minimize-player-btn" class="text-gray-400 hover:text-white flex-shrink-0 ml-2"><i class="fas fa-chevron-down"></i></button>
            </div>
            <div class="flex items-center justify-around mt-2">
                <button id="prev-track-btn" class="text-gray-300 hover:text-white text-base"><i class="fas fa-backward-step"></i></button>
                <button id="play-pause-btn" class="bg-sky-500 text-white w-9 h-9 rounded-full flex items-center justify-center text-base shadow-lg"><i class="fas fa-play"></i></button>
                <button id="next-track-btn" class="text-gray-300 hover:text-white text-base"><i class="fas fa-forward-step"></i></button>
            </div>
            <div class="flex items-center gap-2 mt-2">
                <i class="fas fa-volume-down text-gray-400 text-xs"></i>
                <input type="range" id="volume-slider" class="volume-slider w-full" min="0" max="100" value="30">
                <i class="fas fa-volume-up text-gray-400 text-xs"></i>
            </div>
        </div>
    </div>

    <header class="bg-gray-900/60 backdrop-blur-sm sticky top-0 z-40 shadow-lg border-b border-gray-800">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0"><h1 class="text-2xl font-extrabold text-white cursor-pointer animated-logo"><i class="fas fa-cloud-bolt mr-2 text-sky-400"></i>Xy<span class="text-sky-400">Cloud</span></h1></div>
                <nav class="hidden md:flex items-baseline space-x-4">
                    <a href="#" class="nav-link text-gray-300 hover:text-sky-400 px-3 py-2 rounded-md text-sm font-medium" data-page="home">Home</a>
                    <a href="#" class="nav-link text-gray-300 hover:text-sky-400 px-3 py-2 rounded-md text-sm font-medium" data-page="akun">Jual Akun</a>
                    <a href="#" class="nav-link text-gray-300 hover:text-sky-400 px-3 py-2 rounded-md text-sm font-medium" data-page="spesifikasi">Spesifikasi</a>
                    <a href="#" class="nav-link text-gray-300 hover:text-sky-400 px-3 py-2 rounded-md text-sm font-medium" data-page="tutorial">Tutorial</a>
                    <a href="#" class="nav-link text-gray-300 hover:text-sky-400 px-3 py-2 rounded-md text-sm font-medium" data-page="transaksi">Transaksi</a>
                </nav>
                <div class="flex items-center">
                    <div id="user-info" class="hidden items-center">
                        <span id="user-name" class="text-white text-sm font-medium"></span>
                        <a href="#" id="profile-link" class="ml-4 text-gray-300 hover:text-sky-400 text-sm"><i class="fas fa-user-circle"></i> Profil</a>
                        <button id="logout-btn" class="ml-4 bg-red-600 text-white px-3 py-1 rounded-md text-sm hover:bg-red-700">Logout</button>
                    </div>
                    <div id="login-container">
                         <button id="login-btn-main" class="bg-sky-500 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-sky-600">Login</button>
                    </div>
                     <button id="admin-panel-btn" class="hidden ml-4 bg-yellow-500 text-gray-900 px-3 py-1 rounded-md text-sm hover:bg-yellow-600"><i class="fas fa-user-shield"></i></button>
                    <button id="mobile-menu-button" type="button" class="md:hidden ml-4 bg-gray-800 inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700"><i class="fas fa-bars"></i></button>
                </div>
            </div>
        </div>
        <div class="md:hidden hidden" id="mobile-menu"><nav class="px-2 pt-2 pb-3 space-y-1 sm:px-3"><a href="#" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium" data-page="home">Home</a><a href="#" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium" data-page="akun">Jual Akun</a><a href="#" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium" data-page="spesifikasi">Spesifikasi</a><a href="#" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium" data-page="tutorial">Tutorial</a><a href="#" class="nav-link text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium" data-page="transaksi">Transaksi</a></nav></div>
    </header>

    <main class="container mx-auto p-4 sm:p-6 lg:p-8 min-h-screen">
        <div id="home" class="page"><section class="text-center p-8 md:p-12 rounded-lg backdrop-blur-custom" style="animation: fadeIn 1s ease-out;"><img src="https://share.creavite.co/68cdd4d198ccaa297de6afdb.gif" alt="PC Gaming Banner" class="w-full max-w-md mx-auto mb-6 rounded-lg shadow-lg"><h2 class="text-4xl md:text-5xl font-extrabold text-white mb-4">Rental PC Spek Gacor!</h2><p class="text-lg text-gray-300 max-w-3xl mx-auto mb-8">Mainkan game favoritmu tanpa lag, kerjakan tugas berat, atau live streaming dengan lancar menggunakan PC remote kami.</p><div id="home-sewa-button-container"></div></section><section class="mt-12"><h3 class="text-3xl font-bold mb-6 text-white text-center">Monitoring PC</h3><div id="pc-monitoring" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div></section></div>
        <div id="akun" class="page"><div class="backdrop-blur-custom p-8 rounded-lg shadow-lg max-w-4xl mx-auto"><div class="grid md:grid-cols-2 gap-8 items-center"><div><img src="https://placehold.co/600x400/0f172a/7dd3fc?text=Akun+FiveM" alt="Akun FiveM" class="rounded-lg shadow-lg w-full"></div><div><h2 class="text-3xl font-bold text-sky-400"><i class="fab fa-rocketchat mr-3"></i>Akun Rockstar FiveM</h2><p class="my-4 text-gray-300">Dapatkan akun Rockstar Games dengan lisensi GTA V original, khusus untuk bermain FiveM. Akun ini bersifat private, aman, dan siap pakai.</p><p class="text-sm text-yellow-400 mb-4"><i class="fas fa-exclamation-triangle mr-2"></i>Akun ini tidak bisa digunakan untuk mode Story/Offline GTA V.</p><div class="my-6"><span class="text-4xl font-bold text-white">Rp 25.000</span><span class="text-gray-400">/ permanen</span></div><button id="beli-akun-btn" class="w-full bg-sky-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-sky-600 transition duration-300"><i class="fas fa-shopping-cart mr-2"></i> Beli Sekarang</button></div></div></div></div>
        <div id="spesifikasi" class="page"><h2 class="text-3xl font-bold mb-8 text-white text-center">Spesifikasi & Kegunaan PC</h2><div class="max-w-4xl mx-auto grid md:grid-cols-2 gap-8 items-start"><div class="backdrop-blur-custom p-8 rounded-lg"><h3 class="text-2xl font-bold mb-6 text-white"><i class="fas fa-cogs mr-3 text-sky-400"></i>Spesifikasi PC</h3><ul class="space-y-4 text-gray-300"><li class="flex items-center text-lg"><i class="fas fa-microchip fa-fw mr-4 text-xl text-sky-400"></i>12 Core CPU</li><li class="flex items-center text-lg"><i class="fas fa-memory fa-fw mr-4 text-xl text-sky-400"></i>20 GB RAM</li><li class="flex items-center text-lg"><i class="fas fa-gamepad fa-fw mr-4 text-xl text-sky-400"></i>NVIDIA RTX 3060 Ti</li></ul></div><div class="backdrop-blur-custom p-8 rounded-lg"><h3 class="text-2xl font-bold mb-6 text-white"><i class="fas fa-check-circle mr-3 text-green-400"></i>Cocok Untuk</h3><ul class="space-y-4 text-gray-300"><li class="flex items-center text-lg"><i class="fas fa-video fa-fw mr-4 text-xl text-green-400"></i>Editing & Rendering</li><li class="flex items-center text-lg"><i class="fas fa-code fa-fw mr-4 text-xl text-green-400"></i>Coding & Development</li><li class="flex items-center text-lg"><i class="fas fa-broadcast-tower fa-fw mr-4 text-xl text-green-400"></i>Live Streaming</li><li class="flex items-center text-lg"><i class="fas fa-vr-cardboard fa-fw mr-4 text-xl text-green-400"></i>Gaming Berat</li></ul></div></div></div>
        <div id="tutorial" class="page"><h2 class="text-3xl font-bold mb-8 text-white text-center">Galeri Tutorial Video</h2><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="tutorial-videos"></div></div>
        <div id="transaksi" class="page"><h2 class="text-3xl font-bold mb-6 text-white">Riwayat Transaksi Terkini</h2><div class="backdrop-blur-custom rounded-lg shadow-lg overflow-hidden"><div class="overflow-x-auto"><table class="w-full text-sm text-left text-gray-300"><thead class="text-xs text-gray-100 uppercase bg-gray-900/50"><tr><th scope="col" class="px-6 py-3">Billing ID</th><th scope="col" class="px-6 py-3">Paket</th><th scope="col" class="px-6 py-3">Admin</th><th scope="col" class="px-6 py-3">Status</th></tr></thead><tbody id="transaksi-list"></tbody></table></div></div></div>
        <div id="sewa" class="page"><h2 class="text-3xl font-bold mb-2 text-white">Pilih Admin & Paket Sewa</h2><p class="text-gray-400 mb-6">Status online admin ditentukan otomatis berdasarkan jadwal.</p><div id="admin-selection" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"></div><div id="harga-list-container" class="hidden"><h3 class="text-2xl font-bold mb-4 text-white">List Harga <span id="selected-admin-name"></span></h3><div id="harga-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div></div></div>
        
        <div id="admin-panel" class="page">
            <h2 class="text-3xl font-bold mb-6 text-white">Admin Panel</h2>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-3 backdrop-blur-custom p-6 rounded-lg">
                    <h3 class="text-xl font-semibold mb-4">Buat Transaksi Manual</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <input type="text" id="manual-billing-id" placeholder="Billing ID (dari WA)" class="bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500">
                        <input type="text" id="manual-user-name" placeholder="Nama User (dari WA)" class="bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500">
                        <input type="text" id="manual-paket-name" placeholder="Nama Paket (dari WA)" class="bg-gray-700 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500">
                    </div>
                    <button id="submit-manual-transaction" class="mt-4 w-full md:w-auto bg-green-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-700">
                        <i class="fas fa-plus-circle mr-2"></i>Buat & Simpan Transaksi
                    </button>
                </div>
                <div class="lg:col-span-1 backdrop-blur-custom p-6 rounded-lg">
                    <h3 class="text-xl font-semibold mb-4">Kontrol Status PC</h3>
                    <div id="admin-pc-controls" class="space-y-4"></div>
                </div>
                <div class="lg:col-span-1 backdrop-blur-custom p-6 rounded-lg">
                    <h3 class="text-xl font-semibold mb-4">Manajemen Transaksi</h3>
                    <div id="admin-transaksi-list" class="space-y-3 max-h-96 overflow-y-auto"></div>
                </div>
                <div class="lg:col-span-1 backdrop-blur-custom p-6 rounded-lg">
                    <h3 class="text-xl font-semibold mb-4">Kontrol Status Admin</h3>
                    <div id="admin-status-controls" class="flex flex-wrap gap-4"></div>
                </div>
            </div>
        </div>

        <div id="profile" class="page"><h2 class="text-3xl font-bold mb-6 text-white text-center">Profil Pengguna</h2><div class="max-w-2xl mx-auto backdrop-blur-custom p-8 rounded-lg shadow-lg"><div id="pendapatan-container" class="hidden mb-6"><h3 class="text-lg font-medium text-white">Total Pendapatan (Reseller)</h3><p id="total-pendapatan" class="text-3xl font-bold text-green-400">Rp 0</p></div><div class="space-y-6"><div><label for="profile-email" class="block text-sm font-medium text-gray-300">Email</label><input type="email" id="profile-email" class="mt-1 block w-full bg-gray-800 border-gray-600 rounded-md shadow-sm py-2 px-3 text-gray-400 cursor-not-allowed" readonly></div><div><label for="profile-displayname" class="block text-sm font-medium text-gray-300">Nama Tampilan</label><input type="text" id="profile-displayname" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500"></div><hr class="border-gray-600"><div><h3 class="text-lg font-medium text-white">Ubah Password</h3><p class="text-sm text-gray-400 mb-4">Kosongkan jika tidak ingin mengubah password.</p><label for="profile-new-password" class="block text-sm font-medium text-gray-300">Password Baru</label><input type="password" id="profile-new-password" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500"></div><div class="flex justify-end pt-4"><button id="save-profile-btn" class="bg-sky-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-sky-600"><i class="fas fa-save mr-2"></i> Simpan Perubahan</button></div></div></div></div>
    </main>
    
    <footer class="mt-16 border-t border-gray-800 bg-gray-900/70"><div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center text-gray-400"><h3 class="text-lg font-semibold text-white mb-4">Terhubung Dengan Kami</h3><div class="flex justify-center items-center space-x-6 mb-6"><a href="https://wa.me/6283116632566" target="_blank" class="hover:text-sky-400 transition-colors" title="Customer Service"><i class="fas fa-headset text-2xl"></i></a><a href="https://chat.whatsapp.com/CJ0s93ohwgR7UuI2BMdp0x?mode=ems_copy_t" target="_blank" class="text-green-500 hover:text-green-400 transition-colors" title="Grup WhatsApp"><i class="fab fa-whatsapp-square text-3xl"></i></a><a href="#" class="hover:text-sky-400 nav-link transition-colors" data-page="tutorial" title="FAQ"><i class="fas fa-question-circle text-2xl"></i></a></div><p class="text-xs">&copy; 2025 XyCloud. All rights reserved.</p><p class="text-xs mt-2">Backsound by: MILL WEST</p></div></footer>
    <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"><div class="backdrop-blur-custom p-8 rounded-lg shadow-xl w-full max-w-sm text-left"><h2 class="text-2xl font-bold mb-6 text-white text-center">Login atau Daftar</h2><div class="space-y-4"><div><label for="email-input" class="block text-sm font-medium text-gray-300">Email</label><input type="email" id="email-input" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500" placeholder="nama@email.com"></div><div><label for="password-input" class="block text-sm font-medium text-gray-300">Password</label><input type="password" id="password-input" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500" placeholder="••••••••"></div></div><div class="mt-6 flex flex-col sm:flex-row gap-3"><button id="login-email-btn" class="w-full bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg flex-1">Login</button><button id="register-email-btn" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg flex-1">Daftar</button></div><div class="my-6 flex items-center text-center"><hr class="flex-grow border-gray-600"><span class="mx-4 text-gray-400 text-sm">ATAU</span><hr class="flex-grow border-gray-600"></div><div class="space-y-3"><button id="google-login-btn" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center"><i class="fab fa-google mr-3"></i> Lanjutkan dengan Google</button><button id="anonymous-login-btn" class="w-full bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center"><i class="fas fa-user-secret mr-3"></i> Lanjutkan sebagai Tamu</button></div><button id="close-login-modal" class="mt-6 text-gray-400 hover:text-white w-full text-center">Tutup</button></div></div>
    <div id="sewa-form-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"><div class="backdrop-blur-custom p-8 rounded-lg shadow-xl w-full max-w-md"><h2 class="text-2xl font-bold mb-4 text-white">Formulir Penyewaan</h2><p class="text-gray-400 mb-6">Lengkapi data berikut untuk membuat billing ID.</p><div><label for="whatsapp-input" class="block text-sm font-medium text-gray-300">4 Digit Terakhir No. WhatsApp</label><input type="tel" id="whatsapp-input" maxlength="4" class="mt-1 block w-full bg-gray-700 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-sky-500 focus:border-sky-500" placeholder="Contoh: 2566"></div><div class="mt-6 flex justify-end space-x-4"><button id="cancel-sewa-form" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg">Batal</button><button id="submit-sewa-form" class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-lg">Lanjut ke WhatsApp</button></div></div></div>
    <div id="qris-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"><div class="backdrop-blur-custom p-8 rounded-lg shadow-xl w-full max-w-sm text-center"><h2 id="qris-title" class="text-2xl font-bold mb-4 text-white">Konfirmasi via WhatsApp</h2><div class="w-full h-64 flex items-center justify-center"><i class="fab fa-whatsapp text-9xl text-green-400"></i></div><p id="qris-instruction" class="text-gray-300 mt-2">Silahkan kirim pesan yang sudah disiapkan untuk melanjutkan transaksi.</p><a id="whatsapp-link-qris" href="#" target="_blank" class="mt-6 inline-block w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg"><i class="fab fa-whatsapp mr-2"></i> Kirim Pesan ke Admin</a><button id="close-qris-modal" class="mt-4 text-gray-400 hover:text-white">Tutup</button></div></div>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut, createUserWithEmailAndPassword, signInWithEmailAndPassword, updateProfile, signInAnonymously, updatePassword } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, doc, setDoc, getDoc, updateDoc, query, orderBy, limit, serverTimestamp, where, addDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        const firebaseConfig = { apiKey: "AIzaSyCXUy_NPBoC4scskd6tRJNoJtR0NRAfTJ8", authDomain: "xycloud-531d2.firebaseapp.com", projectId: "xycloud-531d2", storageBucket: "xycloud-531d2.appspot.com", messagingSenderId: "528538517556", appId: "1:52853851756:web:3bd4ac8f6dbd9ad52c8a61", measurementId: "G-Z02Z4EEKY4" };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null, currentUserData = null, selectedSewaData = {}, countdownIntervals = {}, currentTrackIndex = 0;
        const playlist = [ { title: "Jarang pulang", artist: "Lina Lady Geboy", src: "https://j.top4top.io/m_3550yryj20.mp3" }, { title: "Satu Bulan", artist: "MILL WEST", src: "https://f.top4top.io/m_3549csq8c0.mp3" }, { title: "Garam & Madu", artist: "Tenxi", src: "https://g.top4top.io/m_3550tbjv31.mp3" }];
        
        const toastContainer = document.getElementById('toast-container');
        const successSound = document.getElementById('success-sound');
        const errorSound = document.getElementById('error-sound');
        if(successSound) successSound.volume = 0.5; 
        if(errorSound) errorSound.volume = 0.5;

        function showToast(message, type = 'success') { 
            const toast = document.createElement('div'); 
            const iconClass = type === 'success' ? 'fa-check-circle' : (type === 'error' ? 'fa-times-circle' : 'fa-info-circle'); 
            toast.className = `toast toast-${type}`; 
            toast.innerHTML = `<i class="fas ${iconClass}"></i><span>${message}</span>`; 
            toastContainer.appendChild(toast); 
            if (type === 'success' && successSound) successSound.play().catch(e => {}); 
            else if(errorSound) errorSound.play().catch(e => {}); 
            setTimeout(() => { toast.classList.add('show'); }, 100); 
            setTimeout(() => { toast.classList.remove('show'); setTimeout(() => { toast.remove(); }, 500); }, 4000); 
        }

        const pages = document.querySelectorAll('.page');
        const navLinks = document.querySelectorAll('.nav-link');
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const animatedLogo = document.querySelector('.animated-logo');

        function showPage(pageId) { 
            pages.forEach(page => page.classList.remove('active')); 
            const newPage = document.getElementById(pageId); 
            if (newPage) newPage.classList.add('active'); 
            window.scrollTo(0, 0); 
            if(mobileMenu) mobileMenu.classList.add('hidden');
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            navLinks.forEach(link => { link.addEventListener('click', (e) => { e.preventDefault(); showPage(link.dataset.page); }); });
            if(mobileMenuButton) mobileMenuButton.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
            if(animatedLogo) animatedLogo.addEventListener('click', () => showPage('home'));

            // Music Player
            const mainAudioPlayer = document.getElementById('main-audio-player');
            const playPauseBtn = document.getElementById('play-pause-btn'), nextBtn = document.getElementById('next-track-btn'), prevBtn = document.getElementById('prev-track-btn');
            const trackTitleEl = document.getElementById('track-title'), trackArtistEl = document.getElementById('track-artist');
            const musicPlayerEl = document.getElementById('music-player'), minimizePlayerBtn = document.getElementById('minimize-player-btn'), minimizedIcon = document.getElementById('minimized-icon');
            const volumeSlider = document.getElementById('volume-slider');
            function loadTrack(index) { const track = playlist[index]; trackTitleEl.textContent = track.title; trackArtistEl.textContent = track.artist; mainAudioPlayer.src = track.src; mainAudioPlayer.volume = volumeSlider.value / 100; }
            function playTrack() { mainAudioPlayer.play().catch(e => {}); playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>'; }
            function pauseTrack() { mainAudioPlayer.pause(); playPauseBtn.innerHTML = '<i class="fas fa-play"></i>'; }
            playPauseBtn.addEventListener('click', () => { mainAudioPlayer.paused ? playTrack() : pauseTrack(); });
            nextBtn.addEventListener('click', () => { currentTrackIndex = (currentTrackIndex + 1) % playlist.length; loadTrack(currentTrackIndex); playTrack(); });
            prevBtn.addEventListener('click', () => { currentTrackIndex = (currentTrackIndex - 1 + playlist.length) % playlist.length; loadTrack(currentTrackIndex); playTrack(); });
            volumeSlider.addEventListener('input', (e) => { mainAudioPlayer.volume = e.target.value / 100; });
            mainAudioPlayer.addEventListener('ended', () => nextBtn.click());
            minimizePlayerBtn.addEventListener('click', () => musicPlayerEl.classList.add('minimized'));
            minimizedIcon.addEventListener('click', () => musicPlayerEl.classList.remove('minimized'));
            loadTrack(currentTrackIndex);
            
            function updateUIForAuthState(user, isAdmin, displayName) { 
                const loginContainer = document.getElementById('login-container'); 
                const userInfo = document.getElementById('user-info'); 
                const userName = document.getElementById('user-name'); 
                const adminPanelBtn = document.getElementById('admin-panel-btn'); 
                const profileLink = document.getElementById('profile-link'); 
                if (user) { 
                    loginContainer.classList.add('hidden'); 
                    userInfo.classList.remove('hidden'); 
                    userInfo.classList.add('flex'); 
                    userName.textContent = displayName; 
                    profileLink.classList.toggle('hidden', user.isAnonymous); 
                    adminPanelBtn.classList.toggle('hidden', !isAdmin); 
                } else { 
                    loginContainer.classList.remove('hidden'); 
                    userInfo.classList.add('hidden'); 
                    adminPanelBtn.classList.add('hidden'); 
                } 
            }
            
            onAuthStateChanged(auth, async (user) => { 
                currentUser = user; 
                if (user) { 
                    const userDocRef = doc(db, `users/${user.uid}`); 
                    const userDoc = await getDoc(userDocRef); 
                    currentUserData = userDoc.exists() ? { id: user.uid, ...userDoc.data() } : null; 
                    let userData = { 
                        displayName: user.displayName || (user.isAnonymous ? 'Tamu' : 'Pengguna Baru'), 
                        email: user.email, 
                        isAdmin: currentUserData ? currentUserData.isAdmin || false : false,
                        role: currentUserData ? currentUserData.role || 'user' : 'user',
                        name: currentUserData ? currentUserData.name || '' : ''
                    }; 
                    currentUserData = {...currentUserData, ...userData}; // Update global currentUserData
                    updateUIForAuthState(user, userData.isAdmin, userData.displayName); 
                } else { 
                    currentUserData = null; 
                    updateUIForAuthState(null, false, null); 
                } 
            });

            function renderHargaList(admin) { 
                const hargaContainer = document.getElementById('harga-list-container'); 
                const hargaListDiv = document.getElementById('harga-list'); 
                const selectedAdminName = document.getElementById('selected-admin-name'); 
                selectedAdminName.textContent = `(${admin.name})`; 
                hargaListDiv.innerHTML = ''; 
                const prices = admin.prices || {}; 
                const allPrices = [...(prices.perJam || []), ...(prices.paketSiangMalam || []), ...(prices.paketSimpanWaktu || [])]; 
                allPrices.forEach(paket => { 
                    if (paket.bisaKustom) { 
                        hargaListDiv.innerHTML += `<div class="backdrop-blur-custom p-6 rounded-lg shadow-lg flex flex-col col-span-1 md:col-span-2"><h4 class="text-xl font-bold text-sky-400">${paket.nama}</h4><p class="text-lg font-medium my-2 text-white">${new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(paket.harga)} / jam</p><div class="flex items-center gap-4 mt-4"><input type="number" min="1" value="1" class="kustom-jam-input w-20 bg-gray-700 text-center font-bold text-white rounded-md p-2" data-harga-per-jam="${paket.harga}"><span>Jam</span><span class="total-harga-display text-2xl font-bold text-white flex-grow text-right">${new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(paket.harga)}</span></div><button class="mt-4 w-full bg-sky-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-sky-600 sewa-kustom-btn" data-paket-nama="${paket.nama}" data-harga-per-jam="${paket.harga}" data-admin-id="${admin.id}" data-admin-name="${admin.name}" data-admin-whatsapp="${admin.whatsapp}">Sewa Kustom</button></div>`; 
                    } else { 
                        hargaListDiv.innerHTML += `<div class="backdrop-blur-custom p-6 rounded-lg shadow-lg flex flex-col"><h4 class="text-xl font-bold text-sky-400">${paket.nama}</h4><p class="text-3xl font-bold my-4 text-white">${new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(paket.harga)}</p><button class="mt-auto w-full bg-sky-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-sky-600 sewa-paket-btn" data-paket-nama="${paket.nama}" data-paket-harga="${paket.harga}" data-paket-durasi="${paket.durasi}" data-admin-id="${admin.id}" data-admin-name="${admin.name}" data-admin-whatsapp="${admin.whatsapp}">Pilih Paket</button></div>`; 
                    } 
                }); 
                hargaContainer.classList.remove('hidden'); 
            }
            
            function calculateAndDisplayIncome(adminName) { 
                const incomeDisplay = document.getElementById('total-pendapatan'); 
                const q = query(collection(db, 'usageLogs'), where('adminName', '==', adminName)); 
                onSnapshot(q, (snapshot) => { 
                    let totalPendapatan = 0; 
                    snapshot.forEach(doc => { totalPendapatan += doc.data().keuntungan || 0; }); 
                    incomeDisplay.textContent = new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(totalPendapatan); 
                }); 
            }
            
            async function renderAdminView() {
                const adminPcControls = document.getElementById('admin-pc-controls');
                onSnapshot(collection(db, 'pcs'), (snapshot) => { adminPcControls.innerHTML = ''; const pcs = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })).filter(pc => pc.name).sort((a,b) => a.name.localeCompare(b.name)); pcs.forEach(pc => { let timerControlHTML = ''; if (pc.status === 'DIGUNAKAN') { timerControlHTML = `<div class="flex items-center gap-2 mt-2"><input type="number" placeholder="Menit" class="w-20 bg-gray-800 text-white rounded p-1 text-center pc-timer-input"><button class="bg-blue-600 text-white px-2 py-1 rounded text-sm set-waktu-btn" data-id="${pc.id}">Set Waktu</button></div>`; } adminPcControls.innerHTML += `<div class="backdrop-blur-custom p-3 rounded-md border border-gray-700"><div class="flex items-center justify-between"><span class="font-bold">${pc.name}</span><select class="pc-status-select bg-gray-700 text-white rounded p-1" data-id="${pc.id}"><option value="READY" ${pc.status === 'READY' ? 'selected' : ''}>Ready</option><option value="DIGUNAKAN" ${pc.status === 'DIGUNAKAN' ? 'selected' : ''}>Digunakan</option><option value="OFFLINE" ${pc.status === 'OFFLINE' ? 'selected' : ''}>Offline</option></select></div>${timerControlHTML}</div>`; }); });
                const adminTransaksiList = document.getElementById('admin-transaksi-list');
                const transQuery = query(collection(db, 'transactions'), orderBy("timestamp", "desc"), limit(20));
                onSnapshot(transQuery, (snapshot) => { adminTransaksiList.innerHTML = ''; if (snapshot.empty) { adminTransaksiList.innerHTML = '<p class="text-center text-gray-400">Belum ada transaksi.</p>'; return; } snapshot.forEach(doc => { const trx = { id: doc.id, ...doc.data() }; adminTransaksiList.innerHTML += `<div class="backdrop-blur-custom p-3 rounded-md border border-gray-700"><p><strong>ID:</strong> ${trx.billingId} (${trx.userDisplayName})</p><p><strong>Item:</strong> ${trx.paket?.nama || 'N/A'}</p><select class="trx-status-select bg-gray-700 text-white rounded p-1 mt-2 w-full" data-id="${trx.id}" data-trx='${JSON.stringify(trx)}'><option value="Menunggu Pembayaran" ${trx.status === 'Menunggu Pembayaran' ? 'selected' : ''}>Menunggu</option><option value="Selesai" ${trx.status === 'Selesai' ? 'selected' : ''}>Selesai</option></select></div>`; }); });
                const adminStatusControls = document.getElementById('admin-status-controls');
                onSnapshot(collection(db, 'admins'), (snapshot) => { adminStatusControls.innerHTML = ''; const admins = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })).filter(admin => admin.name).sort((a,b) => a.name.localeCompare(b.name)); admins.forEach(admin => { adminStatusControls.innerHTML += `<div class="flex items-center space-x-2"><label class="relative inline-flex items-center cursor-pointer"><input type="checkbox" value="" class="sr-only peer admin-online-toggle" data-id="${admin.id}" ${admin.isOnline ? 'checked' : ''}><div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-500"></div></label><span class="font-bold">${admin.name}</span></div>`; }); });
            }
            
            document.body.addEventListener('change', async (e) => {
                if (e.target.classList.contains('pc-status-select')) { const pcId = e.target.dataset.id; const newStatus = e.target.value; try { await updateDoc(doc(db, 'pcs', pcId), { status: newStatus, endTime: null }); showToast(`Status PC berhasil diubah`, 'success'); } catch (err) { showToast('Gagal mengubah status PC.', 'error'); } }
                if (e.target.classList.contains('trx-status-select')) { const trxId = e.target.dataset.id; const newStatus = e.target.value; try { const trxData = JSON.parse(e.target.dataset.trx); await updateDoc(doc(db, 'transactions', trxId), { status: newStatus }); if (newStatus === 'Selesai' && trxData.admin?.role === 'reseller') { await addDoc(collection(db, 'usageLogs'), { adminName: trxData.admin.name, keuntungan: trxData.keuntungan, paketNama: trxData.paket.nama, userDisplayName: trxData.userDisplayName, timestamp: serverTimestamp() }); } showToast(`Status transaksi berhasil diubah`, 'success'); } catch (err) { showToast('Gagal mengubah status.', 'error'); } }
                if (e.target.classList.contains('admin-online-toggle')) { const adminId = e.target.dataset.id; const isOnline = e.target.checked; try { await updateDoc(doc(db, 'admins', adminId), { isOnline: isOnline }); showToast(`Status admin berhasil diubah`, 'success'); } catch (err) { showToast('Gagal mengubah status admin.', 'error'); } }
            });

            document.body.addEventListener('input', (e) => { 
                if (e.target.classList.contains('kustom-jam-input')) { 
                    const input = e.target; 
                    const hargaPerJam = parseInt(input.dataset.hargaPerJam); 
                    const jumlahJam = parseInt(input.value) || 1; 
                    if (jumlahJam < 1) { input.value = 1; return; } 
                    const totalHarga = hargaPerJam * jumlahJam; 
                    const container = input.closest('.flex.items-center.gap-4'); 
                    const display = container.querySelector('.total-harga-display'); 
                    display.textContent = new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(totalHarga); 
                } 
            });
            
            document.body.addEventListener('click', async (e) => { 
                const target = e.target.closest('button, a');
                if(!target) return;

                if (target.id === 'beli-akun-btn') { 
                    const user = auth.currentUser;
                    if (!user || user.isAnonymous) { document.getElementById('login-modal').classList.remove('hidden'); return; } 
                    document.getElementById('qris-title').textContent = "Beli Akun Rockstar"; 
                    const billingId = `AKUN-${user.uid.slice(0, 4)}-${Date.now().toString().slice(-4)}`; 
                    const waMessage = encodeURIComponent(`Halo, saya ingin konfirmasi pembayaran untuk pembelian Akun Rockstar dengan ID: ${billingId}`); 
                    document.getElementById('qris-instruction').innerHTML = `Tagihan Anda <strong class="text-white">${billingId}</strong>. Silahkan hubungi admin untuk konfirmasi.`; 
                    document.getElementById('whatsapp-link-qris').href = `https://wa.me/6283116632566?text=${waMessage}`; 
                    document.getElementById('qris-modal').classList.remove('hidden'); 
                } 
                if (target.classList.contains('sewa-paket-btn') || target.classList.contains('sewa-kustom-btn')) { 
                    const user = auth.currentUser;
                    if (!user || user.isAnonymous) { document.getElementById('login-modal').classList.remove('hidden'); return; } 
                    const isKustom = target.classList.contains('sewa-kustom-btn'); 
                    const btn = target; 
                    let paketData; 
                    if (isKustom) { 
                        const container = btn.closest('.backdrop-blur-custom'); 
                        const inputJam = container.querySelector('.kustom-jam-input'); 
                        const jumlahJam = parseInt(inputJam.value) || 1; 
                        const hargaPerJam = parseInt(btn.dataset.hargaPerJam); 
                        const totalHarga = jumlahJam * hargaPerJam; 
                        paketData = { nama: `${jumlahJam} Jam (Kustom)`, harga: totalHarga, durasi: jumlahJam * 60, hargaDasar: (btn.dataset.hargaDasar || hargaPerJam) * jumlahJam }; 
                    } else { 
                        paketData = { nama: btn.dataset.paketNama, harga: parseInt(btn.dataset.paketHarga), durasi: parseInt(btn.dataset.paketDurasi), hargaDasar: parseInt(btn.dataset.hargaDasar) || 0 }; 
                    } 
                    const adminData = { id: btn.dataset.adminId, name: btn.dataset.adminName, whatsapp: btn.dataset.adminWhatsapp, role: btn.dataset.adminRole }; 
                    selectedSewaData = { paket: paketData, admin: adminData, keuntungan: paketData.harga - paketData.hargaDasar }; 
                    document.getElementById('whatsapp-input').value = ''; 
                    document.getElementById('sewa-form-modal').classList.remove('hidden'); 
                } 
                if (target.classList.contains('set-waktu-btn')) { 
                    const pcId = target.dataset.id; 
                    const container = target.closest('.backdrop-blur-custom'); 
                    const input = container.querySelector('.pc-timer-input'); 
                    const minutes = parseInt(input.value); 
                    if (!minutes || minutes <= 0) { showToast('Masukkan jumlah menit yang valid.', 'error'); return; } 
                    const endTime = new Date(Date.now() + minutes * 60 * 1000); 
                    try { 
                        await updateDoc(doc(db, 'pcs', pcId), { endTime: endTime }); 
                        showToast(`Timer untuk ${minutes} menit berhasil diatur!`, 'success'); 
                        input.value = ''; 
                    } catch (err) { 
                        showToast('Gagal mengatur timer.', 'error'); 
                    } 
                } 
            });

            document.getElementById('register-email-btn').addEventListener('click', async () => { const email = document.getElementById('email-input').value; const password = document.getElementById('password-input').value; const displayName = prompt("Masukkan nama tampilan Anda (misal: Budi):"); if (!email || password.length < 6 || !displayName) { showToast('Email, password (min. 6 karakter), dan nama tampilan harus diisi.', 'error'); return; } try { const userCredential = await createUserWithEmailAndPassword(auth, email, password); const user = userCredential.user; await updateProfile(user, { displayName: displayName }); const userDocRef = doc(db, `users/${user.uid}`); await setDoc(userDocRef, { displayName: displayName, email: user.email, isAdmin: false, createdAt: serverTimestamp() }); document.getElementById('login-modal').classList.add('hidden'); showToast('Pendaftaran berhasil! Anda sudah login.', 'success'); } catch (error) { showToast(error.code === 'auth/email-already-in-use' ? 'Email ini sudah terdaftar.' : 'Pendaftaran gagal.', 'error'); } });
            document.getElementById('profile-link').addEventListener('click', (e) => { e.preventDefault(); if (!currentUser || currentUser.isAnonymous || !currentUserData) return; document.getElementById('profile-email').value = currentUser.email || 'Tidak ada email'; document.getElementById('profile-displayname').value = currentUser.displayName || ''; document.getElementById('profile-new-password').value = ''; const pendapatanContainer = document.getElementById('pendapatan-container'); if (currentUserData.isAdmin && currentUserData.role === 'reseller') { pendapatanContainer.classList.remove('hidden'); calculateAndDisplayIncome(currentUserData.name); } else { pendapatanContainer.classList.add('hidden'); } showPage('profile'); });
            document.getElementById('save-profile-btn').addEventListener('click', async () => { if (!currentUser) return; const newDisplayName = document.getElementById('profile-displayname').value; const newPassword = document.getElementById('profile-new-password').value; let changesMade = false; try { if (newDisplayName && newDisplayName !== currentUser.displayName) { await updateProfile(currentUser, { displayName: newDisplayName }); const userDocRef = doc(db, `users/${currentUser.uid}`); await updateDoc(userDocRef, { displayName: newDisplayName }); changesMade = true; } if (newPassword) { if (newPassword.length >= 6) { await updatePassword(currentUser, newPassword); changesMade = true; } else { throw new Error('Password baru harus minimal 6 karakter.'); } } showToast(changesMade ? 'Profil berhasil diperbarui!' : 'Tidak ada perubahan.', changesMade ? 'success' : 'info'); showPage('home'); } catch (error) { showToast(error.message, 'error'); } });
            document.getElementById('login-btn-main').addEventListener('click', () => document.getElementById('login-modal').classList.remove('hidden'));
            document.getElementById('close-login-modal').addEventListener('click', () => document.getElementById('login-modal').classList.add('hidden'));
            document.getElementById('logout-btn').addEventListener('click', () => signOut(auth).then(() => showToast('Logout berhasil.')));
            document.getElementById('google-login-btn').addEventListener('click', () => { signInWithPopup(auth, new GoogleAuthProvider()).then(async (result) => { const user = result.user; const userDocRef = doc(db, `users/${user.uid}`); const userDoc = await getDoc(userDocRef); if (!userDoc.exists()) { await setDoc(userDocRef, { displayName: user.displayName, email: user.email, isAdmin: false, createdAt: serverTimestamp() }); } document.getElementById('login-modal').classList.add('hidden'); showToast('Login berhasil!'); }).catch(() => showToast('Login Google gagal.', 'error')); });
            document.getElementById('login-email-btn').addEventListener('click', () => { const email = document.getElementById('email-input').value; const password = document.getElementById('password-input').value; if (!email || !password) { showToast('Email dan password harus diisi.', 'error'); return; } signInWithEmailAndPassword(auth, email, password).then(() => { document.getElementById('login-modal').classList.add('hidden'); showToast(`Selamat datang kembali!`, 'success'); }).catch(() => { showToast('Login gagal. Periksa kembali email dan password Anda.', 'error'); }); });
            document.getElementById('anonymous-login-btn').addEventListener('click', () => { signInAnonymously(auth).then(() => { document.getElementById('login-modal').classList.add('hidden'); showToast('Anda login sebagai tamu.', 'info'); }).catch(() => { showToast('Gagal login sebagai tamu.', 'error'); }); });
            document.getElementById('admin-panel-btn').addEventListener('click', () => { showPage('admin-panel'); renderAdminView(); });
            document.getElementById('cancel-sewa-form').addEventListener('click', () => document.getElementById('sewa-form-modal').classList.add('hidden'));
            
            document.getElementById('submit-sewa-form').addEventListener('click', () => {
                const waInput = document.getElementById('whatsapp-input').value;
                if (waInput.length !== 4 || !/^\d+$/.test(waInput)) { showToast('Mohon masukkan 4 digit angka yang valid.', 'error'); return; }
                const user = auth.currentUser;
                if (!user) { showToast('Gagal: Sesi pengguna tidak ditemukan. Silakan login ulang.', 'error'); return; }
                
                const billingId = `${waInput}-${Date.now().toString().slice(-6)}`;
                const paketInfo = selectedSewaData.paket.nama;
                const adminInfo = selectedSewaData.admin.name;
                const adminWhatsapp = selectedSewaData.admin.whatsapp;

                const message = encodeURIComponent(`Halo Admin ${adminInfo},\n\nSaya ingin sewa PC:\n- Pengguna: ${user.displayName}\n- Paket: ${paketInfo}\n- Billing ID: ${billingId}\n\nMohon konfirmasinya.`);

                document.getElementById('sewa-form-modal').classList.add('hidden');
                document.getElementById('qris-instruction').innerHTML = `Billing ID Anda <strong class="text-white">${billingId}</strong>. Kirim pesan ke admin <strong class="text-white">${adminInfo}</strong> untuk melanjutkan.`;
                document.getElementById('whatsapp-link-qris').href = `https://wa.me/${adminWhatsapp}?text=${message}`;
                document.getElementById('qris-modal').classList.remove('hidden');
                showToast('Silahkan kirim pesan konfirmasi!', 'info');
            });

            document.getElementById('submit-manual-transaction').addEventListener('click', async () => {
                const billingId = document.getElementById('manual-billing-id').value;
                const userName = document.getElementById('manual-user-name').value;
                const paketName = document.getElementById('manual-paket-name').value;

                if (!billingId || !userName || !paketName) { showToast('Semua kolom harus diisi.', 'error'); return; }

                const transactionData = {
                    billingId: billingId,
                    userDisplayName: userName,
                    paket: { nama: paketName },
                    status: "Selesai", // Langsung Selesai karena dibuat manual oleh admin
                    timestamp: serverTimestamp(),
                    adminName: currentUserData?.name || "Admin",
                };

                try {
                    await addDoc(collection(db, 'transactions'), transactionData);
                    showToast('Transaksi berhasil dibuat!', 'success');
                    document.getElementById('manual-billing-id').value = '';
                    document.getElementById('manual-user-name').value = '';
                    document.getElementById('manual-paket-name').value = '';
                } catch (error) {
                    console.error("Manual Transaction Error:", error);
                    showToast('Gagal menyimpan transaksi.', 'error');
                }
            });

            document.getElementById('close-qris-modal').addEventListener('click', () => document.getElementById('qris-modal').classList.add('hidden'));
            
            onSnapshot(collection(db, `pcs`), (snapshot) => { const pcMonitoringDiv = document.getElementById('pc-monitoring'); const homeSewaButtonContainer = document.getElementById('home-sewa-button-container'); pcMonitoringDiv.innerHTML = ''; homeSewaButtonContainer.innerHTML = ''; let isReadyPC = false; Object.values(countdownIntervals).forEach(clearInterval); countdownIntervals = {}; if (snapshot.empty) { pcMonitoringDiv.innerHTML = '<p class="col-span-full text-center text-gray-400 backdrop-blur-custom p-4 rounded-lg">Belum ada PC yang dikonfigurasi.</p>'; return; } const pcData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })).filter(pc => pc.name).sort((a, b) => a.name.localeCompare(b.name)); pcData.forEach(pc => { const statusClass = pc.status === 'READY' ? 'bg-status-ready' : pc.status === 'DIGUNAKAN' ? 'bg-status-digunakan' : 'bg-status-offline'; let timerHTML = `<p class="font-bold text-base">${pc.status}</p>`; if (pc.status === 'DIGUNAKAN' && pc.endTime) { const endTime = pc.endTime.toDate(); const timerElementId = `timer-${pc.id}`; timerHTML = `<p id="${timerElementId}" class="font-bold text-base text-yellow-400">Menghitung...</p>`; countdownIntervals[pc.id] = setInterval(() => { const now = new Date(); const distance = endTime - now; const timerEl = document.getElementById(timerElementId); if(timerEl) { if (distance < 0) { clearInterval(countdownIntervals[pc.id]); timerEl.innerHTML = "Waktu Habis"; timerEl.classList.remove('text-yellow-400'); timerEl.classList.add('text-red-500'); } else { const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0'); const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0'); const seconds = Math.floor((distance % (1000 * 60)) / 1000).toString().padStart(2, '0'); timerEl.innerHTML = `${hours}:${minutes}:${seconds}`; } } }, 1000); } pcMonitoringDiv.innerHTML += `<div class="backdrop-blur-custom rounded-lg shadow-lg flex flex-col"><div class="monitor-icon p-4"><div class="status-dot ${statusClass}"></div><div class="text-center"><i class="fas fa-desktop text-5xl text-gray-500"></i><p class="mt-2 text-base font-bold">${pc.name}</p></div></div><div class="p-2 text-center -mt-2">${timerHTML}</div><div class="mt-auto"><div class="monitor-stand"></div><div class="monitor-base"></div></div></div>`; if (pc.status === 'READY') isReadyPC = true; }); if (isReadyPC) { homeSewaButtonContainer.innerHTML = `<button id="sewa-sekarang-btn" class="bg-sky-500 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-sky-600 transform hover:scale-105 transition-transform duration-300 shadow-lg">Sewa Sekarang <i class="fas fa-arrow-right ml-2"></i></button>`; document.getElementById('sewa-sekarang-btn').addEventListener('click', () => showPage('sewa')); } else { homeSewaButtonContainer.innerHTML = `<button class="bg-gray-600 text-white font-bold py-3 px-8 rounded-lg text-lg cursor-not-allowed" disabled>Semua PC Penuh</button>`; } });
            onSnapshot(collection(db, `admins`), (snapshot) => { const adminSelectionDiv = document.getElementById('admin-selection'); adminSelectionDiv.innerHTML = ''; if (snapshot.empty) return; const now = new Date(new Date().toLocaleString("en-US", {timeZone: "Asia/Makassar"})); const currentHour = now.getHours(); const admins = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })).filter(admin => admin.name).sort((a,b) => a.name.localeCompare(b.name)); admins.forEach(admin => { let isOnline = admin.isOnline; let scheduleText = admin.jadwal || 'Jadwal Fleksibel'; if (admin.jamMulai && admin.jamSelesai) { const jamMulai = parseInt(admin.jamMulai.split(':')[0]); const jamSelesai = parseInt(admin.jamSelesai.split(':')[0]); scheduleText = `${admin.jamMulai} - ${admin.jamSelesai} WITA`; if (jamMulai > jamSelesai) { isOnline = currentHour >= jamMulai || currentHour < jamSelesai; } else { isOnline = currentHour >= jamMulai && currentHour < jamSelesai; } } const statusClass = isOnline ? 'bg-green-500' : 'bg-red-500'; const statusText = isOnline ? 'Online' : 'Offline'; adminSelectionDiv.innerHTML += `<div class="admin-card backdrop-blur-custom p-6 rounded-lg shadow-lg cursor-pointer hover:border-sky-500 transition-all" data-admin-id="${admin.id}"><div class="flex items-center"><div class="relative"><i class="fas fa-user-circle text-4xl text-gray-400"></i><span class="absolute bottom-0 right-0 block h-3.5 w-3.5 rounded-full ${statusClass} ring-2 ring-gray-800"></span></div><div class="ml-4"><h4 class="text-xl font-bold">${admin.name}</h4><p class="text-sm font-semibold ${isOnline ? 'text-green-400' : 'text-red-400'}">${statusText}</p><p class="text-xs text-gray-400 mt-1">${scheduleText}</p></div></div></div>`; }); document.querySelectorAll('.admin-card').forEach(card => { card.addEventListener('click', () => { const adminId = card.dataset.adminId; const selectedAdmin = admins.find(a => a.id === adminId); document.querySelectorAll('.admin-card').forEach(c => c.classList.remove('border-sky-500', 'bg-gray-700/50')); card.classList.add('border-sky-500', 'bg-gray-700/50'); renderHargaList(selectedAdmin); }); }); });
            onSnapshot(query(collection(db, 'transactions'), orderBy("timestamp", "desc"), limit(15)), (snapshot) => { const transaksiList = document.getElementById('transaksi-list'); if(!transaksiList) return; transaksiList.innerHTML = ''; if(snapshot.empty) { transaksiList.innerHTML = '<tr><td colspan="4" class="text-center p-4">Belum ada riwayat transaksi.</td></tr>'; return; } snapshot.forEach(doc => { const trx = doc.data(); const statusClass = trx.status === 'Selesai' ? 'text-green-400' : 'text-yellow-400'; transaksiList.innerHTML += `<tr class="border-b border-gray-700 hover:bg-gray-800/50"><td class="px-6 py-4 font-medium">${trx.billingId}</td><td class="px-6 py-4">${trx.paket?.nama || 'N/A'}</td><td class="px-6 py-4">${trx.adminName || 'Admin'}</td><td class="px-6 py-4 font-bold ${statusClass}">${trx.status}</td></tr>`; }); });
            const tutorialVideosData = [ { title: 'TUTORIAL MAIN FIVEM', link: 'coming soon' }, { title: 'TUTORIAL BUAT AKUN DISCORD', link: 'https://youtu.be/KAuhg-6kXhY?si=8PiS7mxwtSY4QmxP' }, { title: 'TUTORIAL BUAT AKUN STEAM', link: 'https://youtu.be/4kPkifr2ZUI?si=jbhoi6RHUxpORSoa' }, { title: 'TUTORIAL BUAT AKUN CFX.RE', link: 'coming soon' }, { title: 'TUTORIAL ON MIC DI PC DEEPLINK', link: 'https://youtu.be/0PY7c_1FaoM?si=uyZvwTUMjZiU9BaE' }, { title: 'ON MIC ANDROID', link: 'coming soon' } ]; const videoContainer = document.getElementById('tutorial-videos'); videoContainer.innerHTML = ''; tutorialVideosData.forEach(video => { const isComingSoon = video.link === 'coming soon'; const cardHTML = ` <div class="backdrop-blur-custom rounded-lg shadow-lg overflow-hidden flex flex-col"> <div class="relative h-40 bg-gray-800 flex items-center justify-center"> <i class="fab fa-youtube text-5xl text-red-500"></i> ${isComingSoon ? '<div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"><span class="text-white font-bold">SEGERA HADIR</span></div>' : ''} </div> <div class="p-4 flex-grow flex flex-col"> <h3 class="font-bold text-white flex-grow">${video.title}</h3> ${isComingSoon ? '<button class="mt-4 w-full bg-gray-600 text-white font-bold py-2 px-4 rounded-lg cursor-not-allowed" disabled>Tonton</button>' : `<a href="${video.link}" target="_blank" class="mt-4 block text-center w-full bg-red-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-700">Tonton</a>`} </div> </div> `; videoContainer.innerHTML += cardHTML; });
            
            showPage('home');
        });
    </script>
</body>
</html>

